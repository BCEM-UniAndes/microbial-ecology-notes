{"title":"Análisis de diversidad","markdown":{"headingText":"Análisis de diversidad","headingAttr":{"id":"","classes":["unnumbered"],"keyvalue":[]},"containsRefs":false,"markdown":"\n\n\n\n::: {.callout-tip appearance=\"simple\"}\n## Objetivos\nExplorar el flujo de Qiime2 para analizar la diversidad microbiana, considerando la influencia de la profundidad de muestreo, la dependencia de las probabilidades en la evaluación de la diversidad, y realizar cálculos de índices de diversidad junto con curvas de rarefacción.\n:::\n\nUsted obtiene los mismos datos del Taller pasado, amplicones de 16s RNA de peces de mar y río, con la particularidad de que esta vez cada pez no tiene la misma cantidad de lecturas. Usted debe realizar análisis de diversidad de estas secuencias teniendo en cuenta la cantidad de datos que está asignando a cada análisis.\n\n## I. Preparación de ambiente de trabajo\n\n1. Ingrese a la cuenta del clúster.\n\n2. En vez de crear una carpeta copiara la carpeta completa de `datasets`\n\n3. Copie todo el directorio de `Datasets/Taller_4/` a su directorio `Taller4`\n\n4. Ejecute los comandos de este taller en una sesión interactiva preferiblemente con 10G de memoria y al menos 4 cpus per task.\n\n5. Cargue el módulo de QIIME2 disponible en el clúster.\n\n:::{.callout-note appearance=\"simple\"}\nA lo largo del taller tendrá menos ayudas que en anterior, de no saber que ingresar en los flags de los comandos use `–help` para ver que archivos requiere. Anexe también imágenes de los pasos realizados para el resto del taller\n:::\n\n## II. Asignación taxonómica\n\n6. primero va a realizar una asignación taxonómica de los datos con el plugin de sklearn utilizando la base de datos preentrenada de SILVA.\n\n:::{.callout-important appearance=\"simple\"}\nen la carpeta que copió verá el archivo `clasificación.sh`. Primero modifíquelo para que las rutas absolutas coincidan con sus archivos y segundo ejecútelo con `sbatch` (es decir como un *job*) ¿Qué hacer si no sabe si está corriendo?: utilice el comando `squeue –u $USER` y busque en la primera columna su código, si no está allí es porque no está corriendo y deberá ejecutarlo de nuevo.\n:::\n\n7. una vez obtenido el `taxonomy.qza` realizará la diferentes visualizaciones de este artefacto con los siguientes comandos:\n\n```bash\nqiime metadata tabulate\\\n    --m-input-file taxonomy.qza\\\n    --o-visualization taxonomy.qzv\n```\n    \n```bash\nqiime taxa barplot\\\n    --i-table feat-table-T4.qza\\\n    --i-taxonomy taxonomy.qza\\\n    --m-metadata-file metadata.tsv\\\n    --o-visualization taxa-bar-plots.qzv\n```\n\nPara entregar:\n\n- Anexe la visualización de la taxonomía y de los Bar plots en Qiime view organizándolos por su locación\n\n- Observe y señale que acciones le permite Qiime view realizar al archivo de visualización.\n\n- Anexe *Bar plots* con nivel taxonómico de filum y género, y señale las diferencias en las abundancias entre dichos gráficos.\n\n## III. Analisis de diversidad alfa\n\nRecordemos algunas cosas: En el taller pasado ejecutaron dada2 y obtuvieron varios archivos de salida. Entre ellos la tabla de ASVs. Para este taller los datos serán los mismos (10 peces de mar y río) los cuales habrán cambiado un poco con esta tabla usted podrá realizar los análisis de este Taller\n\n8. Lo primero a realizar será usar el plugin de *alpha diversity* de qiime para obtener 3 índices de alfa diversidad: shannon, simpson y chao1\n\n```bash\nqiime diversity alpha\\\n    --i-table feat-table-T4.qza\\\n    --p-metric X\\\n    --o-alpha-diversity X.qza\n```\n\n9. Ahora visualice los índices de diversidad obtenidos en *qiime view* con el comando:\n\n```bash\nqiime diversity alpha-correlation\\\n    --i-alpha-diversity X\\\n    --m-metadata-file X\\\n    --o-visualization X.qzv\n```\n\nPara entregar:\n\n- Analice este índice diferenciando por locación (río vs mar) en cada métrica\n\n## IV. Rarificar los datos\n\n10. Ahora espere. Tómese un momento para preguntarse si lo que acaba de hacer está del todo bien... ¡Acaba de realizar un análisis sin rarificar sus datos!\n\nPara entregar:\n\n- Porqué es importante realizar rarefacción de los datos al hacer análisis de diversidad y que pasaría si se omite dicho paso.\n\n11. Ahora aprenderán a rarificar: lo primero será visualizar un summary de su feature table con el siguiente comando:\n\n```bash\nqiime feature-table summarize\\\n    --i-table feat-table-T4.qza\\\n    --o-visualization X.qzv\\\n    --m-sample-metadata-file X\n```\n\nAl visualizar este archivo qzv podrá observar una tabla muy larga con los conteos de reads para cada muestra (pez).\n\nPara entregar:\n\n- ¿Cuál de esos valores escogería para hacer la rarefacción y por qué?\n\n- Vuelva a realizar la alfa diversidad con los mismos tres índices y señale las principales diferencias. Puede realizar esto con el comando que se muestra a continuación y después visualice como en el punto anterior:\n\n```bash\nqiime diversity alpha-rarefaction\\\n    --i-table feat-table-T4\\\n    --p-max-depth X\\\n    --p-metrics X\\\n    --m-metadata-file X\\\n    --o-visualization X.qzv\\\n```\n\n## V. Análisis de diversidad beta\n\n12. Por último aprenderá a realizar diversidad beta con un plugin llamado `core-metrics`. Lo primero será realizar los árboles filogenéticos como en el taller anterior:\n\n```bash\nqiime phylogeny align-to-tree-mafft-fasttree \\\n    --i-sequences 16s-rep-seqs.qza\\\n    --o-alignment aligned-reps.qza\\\n    --o-masked-alignment masked-aligned.qza\\\n    --o-tree unrooted-tree.qza\\\n    --o-rooted-tree rooted-tree.qza\n```\n\n13. Por último realizará los análisis de core metrics, tenga en cuenta que los resultados serán enviados a una carpeta que usted dará nombre, lo podrá ejecutar con el siguiente comando: \n\n```bash\nqiime diversity core-metrics-phylogenetic\\\n    --i-phylogeny rooted-tree.qza\\\n    -i-table feat-table-T4.qza\\\n    --p-sampling-depth X\\\n    --m-metadata-file metadata-Taller4.tsv\\\n    --output-dir core-metrics-results\n```\n\nPara entregar:\n\n- Obtendrá varios archivos de visualización, Analice los resultados de *bray-curtis*, *unweighted unifrac* y *unweighted unifrac* haciendo diferenciación de colores entre los peces de río y los de mar.","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"ayu","embed-resources":true,"output-file":"04-diversity-analisis.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Artículo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar código fuente","notebook-preview-back":"Volver al Artículo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilización","section-title-copyright":"Derechos de autor","section-title-citation":"Cómo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicación","title-block-modified":"Fecha de modificación","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar todo el código","code-tools-hide-all-code":"Ocultar todo el código","code-tools-view-source":"Ver el código fuente","code-tools-source-code":"Ejecutar el código","tools-share":"Compartir","tools-download":"Descargar","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la búsqueda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.4.543","bibliography":["../references.bib"],"code-annotations":"select","theme":"cosmo","code-copy":"hover"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}