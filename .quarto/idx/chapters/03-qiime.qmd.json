{"title":"Análisis de ASVs con QIIME2","markdown":{"headingText":"Análisis de ASVs con QIIME2","headingAttr":{"id":"","classes":["unnumbered"],"keyvalue":[]},"containsRefs":false,"markdown":"\n\nEl análisis microbiano centrado en amplicones ha sido extensivamente usado en la comprensión de la diversidad microbiana en entornos ambientales. En este contexto, un elemento crucial es el *Amplicon Sequence Variant* (ASV), considerado una entidad única en la secuenciación de amplicones, superando en especificidad a la convencional *Operative Taxonomic Unit* (OTU).\n\nUn proceso fundamental en este ámbito es la derreplicación, que implica la identificación y preservación de secuencias únicas durante el análisis, evitando repeticiones al eliminar copias idénticas. Este procedimiento eleva la precisión al describir la diversidad microbiana.\n\nLa relevancia de la derreplicación radica en su capacidad para mitigar sesgos en la estimación de la diversidad y abundancia, proporcionando así una representación más precisa de la comunidad microbiana. En el campo de la ecología microbiana, la derreplicación se convierte en un componente crucial al reducir la sobreestimación de la diversidad, permitiendo interpretaciones más exactas sobre la estructura y composición de las comunidades microbianas. A lo largo de este taller, exploraremos cómo la derreplicación y otros procesos en QIIME2 contribuyen a la comprensión de la ecología microbiana a partir de datos de secuenciación de amplicones.\n\n:::{.callout-tip appearance=\"simple\"}\n## Objetivos\n\nConocer la metodología para importar datos y crear artefactos, integrar archivos *manifest* y *metadata* de manera efectiva, generar Amplicon Sequence Variants (ASVs) utilizando DADA2 con derreplicación y corrección de errores, explorar archivos de salida para obtener frecuencias de ASVs, construir árboles filogenéticos mediante la metodología de *insertion placement*\n:::\n\n## I. Preparación del ambiente de trabajo\n\n1. Ingrese a la cuenta del clúster.\n\n2. En su directorio, cree un nuevo directorio y nómbrelo `Taller3_Qiime2`.\n\n3. Copie todo el directorio `Taller_3` a su directorio `Taller3_qiime2`. La siguiente es la ruta donde encuentran el archivo a copiar: `/hpcfs/home/cursos/bcom4102/Datasets/Taller3/`\n\n4. Inicie una sesión interactiva preferiblemente con 10G de memoria y al menos 4 cpus per task.\n\n5. Cargue el módulo de QIIME2 disponible en el clúster.\n\n:::{.callout-important appearance=\"simple\"}\nQiime2 es un programa con mucho apoyo de los desarrolladores, muchas personas lo usan y cuando surgen errores estos se han reportado y solucionado en su [foro](https://forum.qiime2.org/). Si tienen problemas esta es su principal herramienta para solucionarlos, aun así, si el problema persiste pueden consultarlo con los monitores.\n:::\n\n# II. Importar datos a QIIME2\n\n6. Primero visualice aquellos archivos que no son secuencias, verá dos, un manifest y un metadata, como podrá observar el *manifest file* contiene la ruta absoluta de donde están los archivos, es necesario que modifique la ruta allí puesta de tal manera que sea la ruta de su carpeta (anexe imagen de la modificación), esto es\nnecesario para poder importar los archivos a qiime2.\n\n7. En este paso, tomaremos el directorio que tiene exclusivamente las secuencias,Data/, primero observe los archivos y diga si son secuencias no pareadas o pareadas (esto es importante ya que Qiime2 trabaja con muchos formatos diferentes), después va a convertirlo al formato con el que trabaja `QIIME2(.qza)` *qiime ziped artifact* o artefacto de Qiime.\n\n```bash\nqiime tools import\\\n    --type 'SampleData[SequencesWithQuality]'\\\n    --input-path manifest-16s.csv\\\n    --output-path\\\n    --input-format SingleEndFastqManifestPhred33\n```\n\n7. Ahora crearemos un archivo de visualización, correspondiente a los datos\nimportados.\n\n```bash\nqiime demux summarize\\\n    --i-data 16s-data.qza\\\n    --o-visualization summ-16s.qzv\n```\n8. Al descargar este artefacto visualizable usted puede ir al [modulo web de visualización](https://view.qiime2.org/) y si arrastra su archivo hasta allí podrá visualizar la información que contiene.\n\n→ Para entregar:\n\n- Con la información dada por el summary, reporte las muestras con mayor y menor número de secuencias respectivamente, así como número de secuencias promedio.\n\n- Describa las variables presentes en el metadata file\n\n- Revise el *mapping file* y describa qué variables se pueden utilizar para posteriores análisis que impliquen clusterizar los datos por categorías presentes en su metadata.\n\n## III. Generación de ASVs\n\n9. En este paso se realiza simultáneamente la derreplicación, el denoising y la generación de las ASVs. Esto se puede realizar con DADA2 en su modo de single end:\n\n```bash\nqiime dada2 denoise-single --i-demultiplexed-seqs 16s-data.qza\\\n    --p-trunc-len X\\\n    --p-trim-left X\\\n    --o-table 16s-feat-table.qza --o-representative-sequences 16s-rep-seqs.qza\\\n    --o-denoising-stats 16s-dada2-stats.qza\\\n```\n\n:::{.callout-important appearance=\"simple\"}\nusted deberá seleccionar los valores para las opciones `--p-trunc-len-f` y `--p-trunc-len-R` con base en la información disponible en la visualización de los datos importados en la pestaña de *interactive quality plot* esto se parece a algo que ya han visto antes.\n:::\n\n10. Ahora convertiremos la tabla y las estadísticas a archivos visualizables.\n\n```bash\nqiime feature-table summarize\\\n    --i-table 16s-feat-table.qza\\\n    --o-visualization 16s-feat-table.qzv\\\n    --m-sample-metadata-file metadata-Taller3.tsv\n```\n\n```bash\nqiime metadata tabulate\\\n    --m-input-file 16s-dada2-stats.qza\\\n    --o-visualization 16s-dada2-stats.qzv\n```\n\n→ Para entregar:\n\n- Explique la función de los flags: `--p-trunc-len` y `--p-trim-left`. Averigüe por qué se consideran como requeridos para DADA2.\n\n- Proporcione los valores que utilizó para el proceso y la razón por la cual\nlos escogió.\n\n- Visualice el archivo de estadísticas de DADA2 y describa qué filtro se hace en cada uno de los pasos del proceso.\n\n- Indique el número de features totales que obtuvo después del proceso y para que los podrá utilizar más adelante.\n\n## IV. Generación del árbol filogenético\n\n11. Con el fin de realizar métricas de diversidad filogenéticas, es necesario\nconstruir primero el árbol filogenético.\n\n```bash\nqiime phylogeny align-to-tree-mafft-fasttree\\\n    --i-sequences 16s-feat-table.qza\\\n    --o-alignment 16s-aligned-reps.qza\\\n    --o-masked-alignment\\\n    --o-tree 16s-unrooted-tree.qza\\\n    --o-rooted-tree 16s-rooted-tree.qza\n```\n\n→ Para entregar:\n• Describa que representan estos tipos de árboles y que los diferencian\n• Además explique la diferencia entre metadata y manifest files.","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"03-qiime.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.543","bibliography":["../references.bib"],"theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"03-qiime.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"block-headings":true,"bibliography":["../references.bib"],"documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}