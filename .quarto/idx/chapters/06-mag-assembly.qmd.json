{"title":"Análisis de MAGs","markdown":{"headingText":"Análisis de MAGs","headingAttr":{"id":"","classes":["unnumbered"],"keyvalue":[]},"containsRefs":false,"markdown":"\n\n::: {.callout-tip appearance=\"simple\"}\n## Objetivos\n1. Describir los pasos generales involucrados en el ensamblaje de genomas y\nmetagenomas a partir de secuencias de lectura corta.\n2. Evaluar la calidad de un ensamblaje y distinguir las características de un buen\nensamblaje a nivel de comunidad y de genomas individuales.\n3. Mapear lecturas de la comunidad a los contigs generados en un ensamblaje de\nmetagenomas y determinar otros aspectos de su calidad a partir de ello.\n4. Considerar los efectos de longitud de k-mero en un ensamblaje.\n:::\n\nDatos: Localización de los datos crudos que debe copiar a su directorio de grupo:\n\n- Genoma:\nDatos de Klebsiella pneumoniae productora de carbapenemase (KPC) número de accesión\nSAMN04102245 obtenidos a partir de secuenciación con Illumina MiSeq PE.\n\n`SRR2915812_1.fastq.gz`\n`SRR2915812_2.fastq.gz`\n\n- Metagenoma:\nComunidad artificial (*mock*) obtenida a partir del recurso mockrobiota. La comunidad *mock* a utilizar corresponde a mock-17, y en este enlace se puede obtener una idea general de la taxonomía esperada de la comunidad bacteriana.\n\n`mock-forward.fastq.gz`\n`mock-reverse.fastq.gz`\n\nRecursos: A lo largo del documento encontrará para su consulta enlaces a los manuales de cada una de las herramientas a utilizar en el desarrollo del taller. Allí encontrará cada uno de los comandos detallando las posibles opciones a usar. \n\nImportante! Seleccione una de las secciones a desarrollar (I ó II), ya sea ensamblaje de genoma individual o de metagenoma. Tenga en cuenta las herramientas que necesitaría usar en su proyecto de semestre para ayudar a decidir qué sección desarrollar. Desarrolle adicionalmente la sección III independiente del tipo de ensamblaje que haya seleccionado.\n\nAntes de iniciar, inicie la sesión interactiva\n\nIndicaciones\n\n## I. Genomas individuales (puntaje 33.3/100)\n\nComo podrá verificar, los archivos de secuencia para el genoma de *Klebsiella pneumoniae* contienen demasiadas lecturas. Solo usaremos un subconjunto del conjunto de datos original para este taller.\n\n1. Cree un directorio de datos en su carpeta de grupo que tenga el nombre `ensamblaje_genoma`\n\n2. Use Seqtk v1.3 y trabaje con una muestra del 25% de las secuencias de estos archivos. Busque el comando en Seqtk para realizar esta labor y nombre los archivos de salida como `klebsiella_0.25_1.fastq` y `klebsiella _2.fastq`, y ubíquelos en el directorio que creó en el paso anterior.\n\nLa calidad del ensamblaje depende en gran medida del tamaño de k-mero utilizado. El tamaño ideal de k-mero depende de la longitud de lectura y la profundidad de secuenciación y la diversidad de la muestra secuenciada.\n\n3. Use SPAdes v3.15.3 y realice dos ensamblajes, uno con longitud de k-mero 61 y otro con longitud 91. Nombre los archivos de modo que reflejen la diferencia en el parámetro. Recuerde también especificar que los archivos de entrada son pareados.\n\n4. Ahora evalúe la calidad de los dos ensamblajes. Utilice QUAST v5.0.2 para esta labor. Utilice como referencia el genoma de *Klebsiella pneumoniae* subsp. pneumoniae HS11286 disponible aquí.\n\n→ Para entregar (genoma Klebsiella pneumoniae): \n\nReportes de QUAST y una explicación que resulte de comparar los ensamblajes realizados con las dos longitudes de k-mero.\n\n## II. Metagenomas (puntaje 33.3/100)\n\nEstos datos ya han sido limpiados y filtrados por calidad. De nuevo, solo usaremos un subconjunto del conjunto de los datos originales para esta sección.\n\n1. Cree un directorio de datos en su carpeta de grupo que tenga el nombre `ensamblaje_metagenoma`\n\n2. Use Seqtk v1.3 y trabaje con una muestra del 25% de las secuencias de estos archivos. Busque el comando en Seqtk para realizar esta labor y nombre los archivos de salida para reflejar este procesamiento y ubíquelos en el directorio que creó en el paso anterior.\n\n3. Realice el ensamblaje del metagenoma con los parámetros por defecto para librerías pareadas usando el software Megahit.\n\n→ Para entregar:\n\n3a. ¿Cuáles son los parámetros por defecto del programa? Consulte.\n\n3b. ¿Que parámetros considera que sería útil modificar? Justifique su respuesta.\n\n4. Utilice QUAST v5.0.2 para revisar los estadísticos del ensamblaje.\n\n→ Para entregar (metagenoma):\n\n4a. Reporte de QUAST.\n\n4b. ¿Qué le indican la longitud total, el número de contigs totales, el número de contigs > 1Kb, y las métricas de N50 y L50?\n\n## III. Mapeo de lecturas al ensamblaje (puntaje 33.3/100)\n\n(ya sea Klebsiella pneumoniae o metagenoma) \nEs importante saber cuál es la contribución de las lecturas obtenidas al ensamblaje resultante. No es lo mismo que los contigs reflejen la información de 80% de las secuencias iniciales a que reflejen solo el 10% de las secuencias de su muestra de interés. Para revisar esto vamos a realizar un procedimiento de mapeo. Si desarrolló la sección I, debe realizar tres mapeos diferentes, según las indicaciones en el punto 5.\n\n5. Use Bowtie2 para mapear las lecturas iniciales al archivo resultante de su ensamblaje, ya sea `final.contigs.fa` producido por Megahit (metagenomas) o los archivos producidos por SPAdes con las diferentes longitudes de k-mero (genoma individual).\n\nPrimero cree el índice usando el comando `bowtie-build`. El comando requiere 2 argumentos. El primer argumento es la referencia FASTA (“final.contigs.fa” en el caso del metagenoma o tres opciones en el ensamblaje de *Klebsiella pneumoniae* individual, ya sea a) el genoma de referencia que descargó de Klebsiella pneumoniae o  b) el ensamblaje con longitud de k-mero 61 y c) el ensamblaje con longitud de k-mero de 91). El segundo argumento es el nombre de archivo \"base\" que se utilizará\n\npara los archivos de índice creados. Creará un montón de archivos que comienzan con nombre_elegido_índice(puede ser `ref_megahit`, `ref_NCBI`, `ref_k61`, o `ref_k91`). Luego, corra el mapeo como tal:\n\n```bash\nbowtie2 -x nombre_elegido_índice\\\n    -1 archivo_1.fastq\\\n    -2 archivo_2.fastq\\\n    -S output.sam\n```\n→ Para entregar (tanto Klebsiella pneumoniae como metagenoma):\n\n5a. ¿Qué porcentaje de lecturas pudo mapear a los contigs generados? ¿Qué conclusiones podría sacar?\n\n5b. ¿Cómo podría cambiar esta visión si solo se mantienen los contigs > 2Kb?\n\n5c. ¿Para qué otras aplicaciones es útil la técnica de mapeo a (meta)genomas de referencia?\n\n## IV. Predicción de genes y análisis funcional (ya sea *Klebsiella pneumoniae* o metagenoma)\n\nPredicción de genes: La predicción de genes es la identificación algorítmica de segmentos de secuencias que son biológicamente funcionales, como los genes codificantes de proteínas, genes codificadores de ARN (e.g, 16S rARN) y secuencias reguladoras. Una vez ensamblado el genoma o el metagenoma, vamos a llevar a cabo la predicción de genes mediante el software Prokka. Ejecute Prokka sobre el ensamblaje realizado según la sección elegida al inicio del taller. Para esto utilice\n\n```bash\nprokka contigs.fa\\\n    --outdir $SAMPLE\\\n    --norrna\\\n    --notrna\\\n    --metagenome\\\n    --cpus 8\n```\n`$SAMPLE` es una variable ambiental en *bash* para reemplazar con el nombre que desee para sus archivos\npor otro lado, la opción `--metegenome` indica que las muestras son metagenomas.\n\nPara entregar (tanto Klebsiella pneumoniae como metagenoma):\n\n- ¿Qué clase de archivos produce como salida Prokka?\n\n- Visualice el archivo GFF con el comando `grep -v \"^#\" $SAMPLE | less –S`. ¿Cuántas regiones codificantes encontró?\n\n-. ¿Para qué sirve el archivo `.ffa`?\n\nAhora realizaremos la anotación funcional de los genes predichos y los visualizaremos gráficamente. Para esto, utilizaremos `COGclassifier`. Este software permite realizar la búsqueda de secuencias de consulta en la base de datos COG, pasando por la anotación y clasificación de las funciones de los genes, hasta la generación de figuras.\n\nEs necesario que el número de threads sea 8 `--thread_num 8` \n\nPara entregar (tanto Klebsiella pneumoniae como metagenoma):\n\n- Identifique los archivos generados. ¿Qué indica cada uno?\n- ¿Qué porcentaje de secuencias fueron clasificadas?\n- ¿Qué le indican las gráficas generadas? Adjunte las imágenes.","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"ayu","embed-resources":true,"output-file":"06-mag-assembly.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Artículo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar código fuente","notebook-preview-back":"Volver al Artículo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilización","section-title-copyright":"Derechos de autor","section-title-citation":"Cómo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicación","title-block-modified":"Fecha de modificación","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar todo el código","code-tools-hide-all-code":"Ocultar todo el código","code-tools-view-source":"Ver el código fuente","code-tools-source-code":"Ejecutar el código","tools-share":"Compartir","tools-download":"Descargar","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la búsqueda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.4.543","bibliography":["../references.bib"],"code-annotations":"select","theme":"cosmo","code-copy":"hover"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}